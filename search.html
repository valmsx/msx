<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>YouTube MSX Plugin</title>
    <script>
      async function fetchResults() {
        const params = new URLSearchParams(window.location.search);
        const input = params.get("input") || "";

        if (!input) {
          msx.error("Nessun termine di ricerca fornito.");
          return;
        }

        try {
          const url = `https://youtube-flask-proxy.onrender.com/msx_search?input=${encodeURIComponent(input)}`;
          const res = await fetch(url);
          if (!res.ok) throw new Error(`Errore HTTP: ${res.status}`);
          const data = await res.json();
          msx.load(data);
        } catch (err) {
          msx.error("Errore nel caricamento dei risultati.");
          console.error(err);
        }
      }

      document.addEventListener("DOMContentLoaded", fetchResults);
    </script>
  </head>
  <body></body>
</html>
